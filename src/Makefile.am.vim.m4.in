{%|"
" This file was generated by GATBPS @PACKAGE_VERSION@, which was
" released on @PACKAGE_DATE@. Before changing it, make sure
" you're doing the right thing. Depending on how GATBPS
" is being used, your changes may be automatically lost.
" A short description of this file follows.
"
" Special file: Makefile.am.vim
"
" For more information, see the GATBPS manual.
"

let s:s1 = '^## begin_variables$'
let s:s2 = '^## end_variables$'

call cursor(1, 1)
let s:n1 = search(s:s1, 'cW')
if s:n1 != 0 && search(s:s1, 'W') != 0
  echoerr '''' . s:s1 . ''' appears twice'
  finish
endif

call cursor(1, 1)
let s:n2 = search(s:s2, 'cW')
if s:n2 != 0 && search(s:s2, 'W') != 0
  echoerr '''' . s:s2 . ''' appears twice'
  finish
endif

if s:n1 != 0 && s:n2 == 0
  echoerr '''' . s:s1 . ''' appears without ''' . s:s2 . ''''
  finish
endif

if s:n1 == 0 && s:n2 != 0
  echoerr '''' . s:s2 . ''' appears without ''' . s:s1 . ''''
  finish
endif

if s:n1 != 0 && s:n2 != 0

  if s:n1 > s:n2
    echoerr '''' . s:s1 . ''' appears after ''' . s:s2 . ''''
    finish
  endif

:%sm/^## begin_variables$/&\r/
:%sm/^## end_variables$/\r&/
:/^## begin_variables$/+1,/^## end_variables$/-1g/./s/$/\b/
:/^## begin_variables$/+1,/^## end_variables$/-2g/^\n./.+1,/^$/-1j!
:/^## begin_variables$/+1,/^## end_variables$/-1g/^$/d
:%sm/^## begin_variables$/&\r/
:/^## begin_variables$/+1,/^## end_variables$/-1sort
:/^## begin_variables$/+1,/^## end_variables$/-1s/\b/\r/eg
:/^## begin_variables$/+1,/^## end_variables$/-1g/+=/.,/^$/-1sort u

endif

let s:s1 = '^## begin_rules$'
let s:s2 = '^## end_rules$'

call cursor(1, 1)
let s:n1 = search(s:s1, 'cW')
if s:n1 != 0 && search(s:s1, 'W') != 0
  echoerr '''' . s:s1 . ''' appears twice'
  finish
endif

call cursor(1, 1)
let s:n2 = search(s:s2, 'cW')
if s:n2 != 0 && search(s:s2, 'W') != 0
  echoerr '''' . s:s2 . ''' appears twice'
  finish
endif

if s:n1 != 0 && s:n2 == 0
  echoerr '''' . s:s1 . ''' appears without ''' . s:s2 . ''''
  finish
endif

if s:n1 == 0 && s:n2 != 0
  echoerr '''' . s:s2 . ''' appears without ''' . s:s1 . ''''
  finish
endif

if s:n1 != 0 && s:n2 != 0

  if s:n1 > s:n2
    echoerr '''' . s:s1 . ''' appears after ''' . s:s2 . ''''
    finish
  endif

:%sm/^## begin_rules$/&\r/
:%sm/^## end_rules$/\r&/
:/^## begin_rules$/+1,/^## end_rules$/-1g/./s/$/\b/
:/^## begin_rules$/+1,/^## end_rules$/-2g/^\n./.+1,/^$/-1j!
:/^## begin_rules$/+1,/^## end_rules$/-1g/^$/d
:/^## begin_rules$/+1,/^## end_rules$/-1sort
:/^## begin_rules$/+1,/^## end_rules$/-1s/\b/\r/g
:%sm/^## begin_rules$/&\r/
:/^## begin_rules$/+1,/^## end_rules$/-2g/^$/.+1,/^\($\|\t\)/-1sort u

endif

"
" The authors of this file have waived all copyright and
" related or neighboring rights to the extent permitted by
" law as described by the CC0 1.0 Universal Public Domain
" Dedication. You should have received a copy of the full
" dedication along with this file, typically as a file
" named <CC0-1.0.txt>. If not, it may be available at
" <https://creativecommons.org/publicdomain/zero/1.0/>.
"|%}
